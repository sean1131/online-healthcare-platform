<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Account - Farmersea</title>
  <link rel="stylesheet" href="profile.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyC3BzzTtffo9hxv_zNeU8D9-MJB0PgIuAs",
      authDomain: "team5app-20eb7.firebaseapp.com",
      projectId: "team5app-20eb7",
      storageBucket: "team5app-20eb7.appspot.com",
      messagingSenderId: "946605117578",
      appId: "1:946605117578:web:6f0f5cd91c689ca1f05d73"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <header>
    <div class="logo">
      <a href="home.html" style="text-decoration: none; color: inherit;">
        <span class="logo-text">Farmer</span>
        <span class="logo-sub">SEA</span>
      </a>
    </div>
    <a href="profile.html" class="account-link" id="accountNavBtn" style="display: none; flex-direction: column; align-items: center; gap: 2px; text-decoration: none; color: inherit;">
        <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Account">
        <span style="font-size: 1em;">Account</span>
      </a>
  </header>
  <div class="profile-container">
    <aside class="sidebar">
      <div class="sidebar-user">
        <div class="user-icon"><i class="fa fa-user-circle fa-3x"></i></div>
        <div class="user-email" id="userEmail">User</div>
      </div>
      <nav class="sidebar-nav">
        <a href="#" class="sidebar-link active"><i class="fa fa-user"></i> My Profile</a>
        <button class="sidebar-link" id="signOutBtn"><i class="fa fa-sign-out-alt"></i> Sign Out</button>
        <button class="sidebar-link delete" id="deleteAccountBtn"><i class="fa fa-user-times"></i> Delete Account</button>
      </nav>
    </aside>
    <main class="profile-main">
      <h2>Profile Setting</h2>
      <form id="profileForm" class="profile-form">
        <div class="profile-row">
          <div class="profile-field">
            <label>Full Name</label>
            <input type="text" id="fullName" placeholder="Full Name">
          </div>
        </div>
        <div class="profile-row">
          <div class="profile-field">
            <label>NRIC/Passport</label>
            <input type="text" id="nric" placeholder="NRIC/Passport">
          </div>
          <div class="profile-field">
            <label>Phone Number</label>
            <input type="text" id="phoneNumber" placeholder="Phone Number">
          </div>
          <div class="profile-field">
            <label>Email Address</label>
            <input type="email" id="emailAddress" placeholder="Email Address" disabled>
          </div>
        </div>
        <div class="profile-row">
          <div class="profile-field">
            <label>Date of Birth</label>
            <input type="date" id="dob" placeholder="Date of Birth">
          </div>
          <div class="profile-field">
            <label>Height (in cm)</label>
            <input type="number" id="height" placeholder="Height (cm)">
          </div>
          <div class="profile-field">
            <label>Weight (in kg)</label>
            <input type="number" id="weight" placeholder="Weight (kg)">
          </div>
          <div class="profile-field">
            <label>Gender</label>
            <select id="gender">
              <option value="">Select...</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
              <option value="Other">Other</option>
            </select>
          </div>
        </div>
        <div class="profile-row">
          <div class="profile-field" style="flex:2;">
            <label>Home Address</label>
            <input type="text" id="address" placeholder="Home Address">
          </div>
        </div>
        <div class="profile-row">
          <div class="profile-field">
            <label>Country</label>
            <select id="country">
              <option value="Malaysia">Malaysia</option>
            </select>
          </div>
          <div class="profile-field">
            <label>State</label>
            <input type="text" id="state" placeholder="State">
          </div>
          <div class="profile-field">
            <label>City</label>
            <input type="text" id="city" placeholder="City">
          </div>
          <div class="profile-field">
            <label>Postcode</label>
            <input type="text" id="postcode" placeholder="Postcode">
          </div>
        </div>
        <button type="button" id="saveProfileBtn" class="btn main-btn" style="margin-top: 18px; width: 120px;">Save</button>
        <div id="profileMessage" style="color: green; margin-top: 10px;"></div>
      </form>
    </main>
  </div>
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
        <h3>FarmerSEA</h3>
        <p>Your trusted online doctor and pharmacy platform, providing quality healthcare services across Southeast Asia.</p>
        <div class="social-links">
          <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
          <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
          <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
          <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
        </div>
      </div>
      <div class="footer-section">
        <h4>Services</h4>
        <ul>
          <li><a href="pharmacy.html">Online Pharmacy</a></li>
          <li><a href="booking.html">Doctor Consultation</a></li>
          <li><a href="Q&A.html">Health Q&A</a></li>
          <li><a href="#">Health Screening</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Support</h4>
        <ul>
          <li><a href="#">Contact Us</a></li>
          <li><a href="#">Help Center</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Terms of Service</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Contact Info</h4>
        <div class="contact-info">
          <p><i class="fas fa-phone"></i> +60 12-345 6789</p>
          <p><i class="fas fa-envelope"></i> info@farmersea.com</p>
          <p><i class="fas fa-map-marker-alt"></i> Kuala Lumpur, Malaysia</p>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2024 FarmerSEA. All rights reserved.</p>
    </div>
  </footer>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script>
    // Show user email and load profile
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        document.getElementById('userEmail').textContent = user.email;
        document.getElementById('emailAddress').value = user.email;
        const db = firebase.firestore();
        db.collection('profiles').doc(user.uid).get().then(function(doc) {
          if (doc.exists) {
            const data = doc.data();
            document.getElementById('fullName').value = data.fullName || '';
            document.getElementById('phoneNumber').value = data.phoneNumber || '';
            document.getElementById('nric').value = data.nric || '';
            document.getElementById('dob').value = data.dob || '';
            document.getElementById('gender').value = data.gender || '';
            document.getElementById('address').value = data.address || '';
            document.getElementById('country').value = data.country || '';
            document.getElementById('state').value = data.state || '';
            document.getElementById('city').value = data.city || '';
            document.getElementById('postcode').value = data.postcode || '';
            document.getElementById('height').value = data.height || '';
            document.getElementById('weight').value = data.weight || '';
          }
        });
      } else {
        window.location.href = 'home.html';
      }
    });
    document.getElementById('saveProfileBtn').onclick = function() {
      const user = firebase.auth().currentUser;
      if (!user) return;
      const db = firebase.firestore();
      db.collection('profiles').doc(user.uid).set({
        fullName: document.getElementById('fullName').value,
        phoneNumber: document.getElementById('phoneNumber').value,
        nric: document.getElementById('nric').value,
        dob: document.getElementById('dob').value,
        height: document.getElementById('height').value,
        weight: document.getElementById('weight').value,
        gender: document.getElementById('gender').value,
        address: document.getElementById('address').value,
        country: document.getElementById('country').value,
        state: document.getElementById('state').value,
        city: document.getElementById('city').value,
        postcode: document.getElementById('postcode').value
      }).then(function() {
        document.getElementById('profileMessage').textContent = 'Profile saved!';
        setTimeout(function(){ document.getElementById('profileMessage').textContent = ''; }, 2000);
      });
    };
    document.getElementById('signOutBtn').onclick = function() {
      firebase.auth().signOut().then(function() {
        window.location.href = 'home.html';
      });
    };
    document.getElementById('deleteAccountBtn').onclick = function() {
      if (confirm('Are you sure you want to delete your account? This cannot be undone.')) {
        const user = firebase.auth().currentUser;
        user.delete().then(function() {
          alert('Account deleted.');
          window.location.href = 'home.html';
        }).catch(function(error) {
          alert('Error deleting account: ' + error.message);
        });
      }
    };
  </script>
</body>
</html> 